var t={};class e{static gameStatus={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.score=0,this.status=e.gameStatus.idle,this.state=t.map(t=>[...t])}getRandomCell(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push([e,s]);if(t.length>0){let e=Math.floor(Math.random()*t.length),[s,a]=t[e];this.state[s][a]=.9>Math.random()?2:4}}checkStatus(){let t=!1,s=!1;for(let a=0;a<4;a++)for(let i=0;i<4;i++){let r=this.state[a][i];2048===r&&this.status!==e.gameStatus.win&&(this.status=e.gameStatus.win),0===r&&(t=!0),(a<3&&r===this.state[a+1][i]||i<3&&r===this.state[a][i+1])&&(s=!0)}t||s||(this.status=e.gameStatus.lose)}moveLeft(){let t=this.state.map(t=>t.slice());for(let t=0;t<4;t++){let e=this.state[t].filter(t=>0!==t),s=[];for(let t=0;t<e.length;t++)e[t]===e[t+1]?(s.push(2*e[t]),this.score+=2*e[t],t++):s.push(e[t]);this.state[t]=s.concat(Array(4-s.length).fill(0))}this.checkForChanges(t),this.checkStatus()}moveRight(){let t=this.state.map(t=>t.slice());for(let t=0;t<4;t++){let e=this.state[t].filter(t=>0!==t).reverse(),s=[];for(let t=0;t<e.length;t++)e[t]===e[t+1]?(s.push(2*e[t]),this.score+=2*e[t],t++):s.push(e[t]);this.state[t]=Array(4-s.length).fill(0).concat(s.reverse())}this.checkForChanges(t),this.checkStatus()}moveUp(){this.state=this.transpose(this.state),this.moveLeft(),this.state=this.transpose(this.state)}moveDown(){this.state=this.transpose(this.state),this.moveRight(),this.state=this.transpose(this.state)}transpose(t){let e=[];for(let s=0;s<4;s++){e[s]=[];for(let a=0;a<4;a++)e[s].push(t[a][s])}return e}checkForChanges(t){this.state.toString()!==t.toString()&&(this.getRandomCell(),this.status=e.gameStatus.playing)}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status=e.gameStatus.playing,this.getRandomCell()}restart(){this.state=this.initialState.map(t=>[...t]),this.score=0,this.status=e.gameStatus.idle}}const s=new(t=e),a=document.querySelector(".start"),i=document.querySelector(".game-score"),r=document.querySelector(".game-field"),l=document.querySelector(".message-lose"),o=document.querySelector(".message-win"),n=document.querySelector(".message-start");function h(){r.innerHTML="";let t=s.getState();for(let e=0;e<4;e++){let s=document.createElement("tr");for(let a=0;a<4;a++){let i=document.createElement("td"),r=t[e][a];i.textContent=0!==r?r:"",i.classList.add("field-cell"),0!==r&&i.classList.add(`field-cell--${r}`),s.appendChild(i)}r.appendChild(s)}}function c(){i&&(i.textContent=s.getScore())}function d(){let e=s.getStatus();o.classList.toggle("hidden",e!==t.gameStatus.win),l.classList.toggle("hidden",e!==t.gameStatus.lose)}a.addEventListener("click",()=>{a.classList.contains("start")?(s.start(),a.classList.remove("start"),a.classList.add("restart"),a.textContent="Restart",n.classList.add("hidden"),l.classList.add("hidden"),o.classList.add("hidden")):a.classList.contains("restart")&&(s.restart(),a.classList.remove("restart"),a.classList.add("start"),a.textContent="Start",n.classList.remove("hidden"),l.classList.add("hidden"),o.classList.add("hidden")),h(),c()}),document.addEventListener("keyup",t=>{let e={ArrowRight:s.moveRight,ArrowLeft:s.moveLeft,ArrowUp:s.moveUp,ArrowDown:s.moveDown};e[t.key]&&e[t.key].call(s),h(),c(),d()}),h(),d(),c();
//# sourceMappingURL=index.3994a63d.js.map
